<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Teste 1</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<meta name="robots" content="nofollow">
	<meta name="googlebot" content="noindex">
	<style type="text/css">
		.textoDIV{
			font-size: 30px;
			color: black;
		}
	</style>
</head>
<body>
	<div class="textoDIV"></div>
	<script type="text/javascript">
		setInterval(function(){
			getData();

			//var retorno = readTextFile();
			//readTextFile();
			
		},5000);

		function getData(){
			$.ajax({
	        url: "text.txt",
	        async: false,   // asynchronous request? (synchronous requests are discouraged...)
	        cache: false,   // with this, you can force the browser to not make cache of the retrieved data
	        dataType: "text",  // jQuery will infer this, but you can set explicitly
	        success: function( data, textStatus, jqXHR ) {
	            var resourceContent = data; // can be a global variable too...
	            console.log(resourceContent);
	            comando(resourceContent);
	        }
   		});

			// $.get( "text.txt", function( data ) {
	  //       	var resourceContent = data; // can be a global variable too...
	  //      		console.log(resourceContent);
	  //   	});
		}

		// function readTextFile(){
		// 	fetch('text.txt').then(function(response) {
		// 	    if (response.status !== 200) {
		// 	        throw response.status;
		// 	    }
		// 	    return response.text().then(function(text) {
		// 	      console.log(">>"+text);
		// 	      //comando(text);
		// 	    });
		// 	}).then(function(file_content) {
		// 	    //console.log(file_content);
		// 	}).catch(function(status) {
		// 	    console.log('Error ' + status);
		// 	});			
		// }

		// function readTextFile(file){
		// 	var rawFile = new XMLHttpRequest();
		//     rawFile.open("GET", file, false);
		//     rawFile.onreadystatechange = function (){
		//         if(rawFile.readyState === 4){
		//             if(rawFile.status === 200 || rawFile.status == 0){
		//                 var textoArquivo = rawFile.responseText;
		//                 return textoArquivo;
		//                 //comando(textoArquivo);
		//                 //ela2.comando(textoArquivo);
		//             }
		//         }
		//     }
		//     rawFile.send(null);
		//     return "null"
		// }

		//comando que esta na "ela.js"
		function comando(comando){
			if(comando == "outback"){
				document.querySelector('.textoDIV').textContent = comando;
				apagaArquivo();
			}
			if(comando == "carai burracha"){
				document.querySelector('.textoDIV').textContent = comando;
				apagaArquivo();
			}
			//apagaArquivo();
		}
		
		function apagaArquivo(){
			var data = {
            	apaga: "text"
        	};			
			var x = $.post("controle.php", data);
			return x;
		}




		// function loadJSON(callback){ 
		// 	var xobj = new XMLHttpRequest();
		// 	xobj.overrideMimeType("application/json");
		// 	xobj.open('GET', 'file.json', true); // Replace 'my_data' with the path to your file
		// 	xobj.onreadystatechange = function () {
		// 	if (xobj.readyState == 4 && xobj.status == "200") {
		// 		// Required use of an anonymous callback as .open will NOT return a value but simply returns undefined in asynchronous mode
		// 		console.log(xobj.responseText);
		// 		//callback(xobj.responseText);
		// 	}
		// 	};
		// 	xobj.send(null); 
		// }

		// 	 loadJSON(function(response) {
		// 	  // Parse JSON string into object
		// 	    var actual_JSON = JSON.parse(response);
		// 	 });

			 //console.log(loadJSON());

		// function loadDoc() {
		//   var xhttp = new XMLHttpRequest();
		//   xhttp.onreadystatechange = function() {
		//     if (this.readyState == 4 && this.status == 200) {
		//      document.getElementById("demo").innerHTML = this.responseText;
		//     }
		//   };
		//   xhttp.open("GET", "ajax_info.txt", true);
		//   xhttp.send();
		// }

		// loadDoc();
	</script>
</body>
</html>